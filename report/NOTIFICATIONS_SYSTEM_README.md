# نظام الإشعارات وتتبع الطلبات

## المميزات

✅ **إشعارات تلقائية** عند:
- إنشاء طلب جديد
- بدء معالجة الطلب
- شحن الطلب
- تسليم الطلب
- إلغاء الطلب

✅ **تتبع الطلبات** برقم تتبع فريد لكل طلب

✅ **صفحة إشعارات** لعرض جميع الإشعارات

✅ **صفحة تتبع** لعرض حالة الشحن بالتفصيل

## التثبيت

### 1. تحديث قاعدة البيانات

قم بتشغيل ملف SQL التالي في phpMyAdmin:

```sql
-- ملف: database/add_notifications_system.sql
```

هذا الملف سيقوم بـ:
- إضافة حقول `tracking_number` و `shipping_status` لجدول `orders`
- إنشاء جدول `notifications` الجديد

### 2. الملفات المضافة

- `notifications.php` - صفحة عرض الإشعارات
- `track-order.php` - صفحة تتبع الطلب
- `database/add_notifications_system.sql` - ملف تحديث قاعدة البيانات

### 3. الملفات المحدثة

- `checkout.php` - إضافة رقم تتبع وإنشاء إشعار عند إنشاء الطلب
- `admin.php` - إضافة وظيفة تحديث حالة الشحن وإرسال إشعارات
- `orders.php` - إضافة عرض رقم التتبع
- `includes/header.php` - إضافة رابط الإشعارات مع عداد الإشعارات غير المقروءة

## كيفية الاستخدام

### للعملاء:

1. **عرض الإشعارات**: اضغط على أيقونة الجرس في القائمة العلوية
2. **تتبع الطلب**: اضغط على رقم التتبع في صفحة الطلبات أو الإشعارات
3. **تحديد كمقروء**: اضغط على "تحديد كمقروء" في أي إشعار

### للمدير:

1. **تحديث حالة الشحن**: 
   - اذهب إلى لوحة التحكم → إدارة المبيعات
   - اختر حالة الشحن من القائمة المنسدلة
   - سيتم إرسال إشعار تلقائي للعميل

2. **حالات الشحن المتاحة**:
   - قيد الانتظار (pending)
   - قيد المعالجة (processing)
   - تم الشحن (shipped)
   - تم التسليم (delivered)
   - ملغي (cancelled)

## أنواع الإشعارات

- `order_created` - تم إنشاء طلب جديد
- `order_processing` - جاري معالجة الطلب
- `order_shipped` - تم شحن الطلب
- `order_delivered` - تم تسليم الطلب
- `order_cancelled` - تم إلغاء الطلب
- `general` - إشعارات عامة

## رقم التتبع

كل طلب يحصل على رقم تتبع فريد تلقائياً عند الإنشاء:
- الصيغة: `TRK` + معرف فريد
- مثال: `TRK65A1B2C3D4E5F`

## ملاحظات

- الإشعارات تظهر فقط للمستخدمين المسجلين
- يمكن للمستخدم تحديد الإشعارات كمقروءة
- عداد الإشعارات غير المقروءة يظهر في القائمة العلوية
- عند تحديث حالة الشحن من لوحة التحكم، يتم إرسال إشعار تلقائي للعميل

